#!/usr/bin/env bash
set -euo pipefail

REPO_DIR="$HOME/obsidian-vault/"

if [[ ! -d "$REPO_DIR" ]]; then
  echo "Repository directory not found: $REPO_DIR" >&2
  exit 1
fi

cd "$REPO_DIR"

if [[ ! -d ".git" ]]; then
  echo "Not a git repository: $REPO_DIR" >&2
  exit 1
fi

COMMIT_DATE="$(date '+%Y-%m-%d %H:%M')"

COMMIT_MESSAGE="Auto commit â€” $COMMIT_DATE"

git add .

if git diff --cached --quiet; then
  echo "No changes to commit"
  exit 0
fi

git commit -m "$COMMIT_MESSAGE"
git push
